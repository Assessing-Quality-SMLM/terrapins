package com.coxphysics.terrapins.models.hawkman.snippets;

import com.coxphysics.terrapins.models.hawkman.unit_testing_snippets.GaussianBlur;
import ij.process.FloatProcessor;
import ij.process.ImageProcessor;
import org.junit.jupiter.api.Test;

import static com.coxphysics.terrapins.models.hawkman.unit_testing_snippets.Helpers.create_test_image;
import static org.junit.jupiter.api.Assertions.assertArrayEquals;

public class GaussianBlurTests
{
    @Test
    public void blur_test()
    {
        ImageProcessor image = create_test_image(10);
        FloatProcessor result = GaussianBlur.blur(image, 2.355);
        float[] expected = new float[]{10.177295f, 10.761863f, 11.500699f, 12.35561f, 13.279178f, 14.224997f, 15.148564f, 16.003473f, 16.742313f, 17.32688f, 16.022966f, 16.607533f, 17.346367f, 18.201279f, 19.124847f, 20.070665f, 20.994236f, 21.849146f, 22.58798f, 23.172552f, 23.411343f, 23.995909f, 24.734747f, 25.589659f, 26.513224f, 27.459042f, 28.382608f, 29.237518f, 29.976357f, 30.560925f, 31.960436f, 32.545006f, 33.28384f, 34.138752f, 35.06232f, 36.008137f, 36.93171f, 37.786613f, 38.525448f, 39.110016f, 41.196114f, 41.78068f, 42.51952f, 43.37443f, 44.297997f, 45.243816f, 46.167385f, 47.022297f, 47.76113f, 48.3457f, 50.654305f, 51.238865f, 51.9777f, 52.832615f, 53.756187f, 54.702f, 55.625572f, 56.480476f, 57.219315f, 57.803886f, 59.889977f, 60.47455f, 61.21338f, 62.06829f, 62.991867f, 63.93768f, 64.861244f, 65.716156f, 66.45499f, 67.039566f, 68.43908f, 69.02364f, 69.762474f, 70.617386f, 71.540955f, 72.48678f, 73.41034f, 74.26524f, 75.00408f, 75.58866f, 75.827446f, 76.41202f, 77.150856f, 78.00576f, 78.92933f, 79.87517f, 80.798706f, 81.65363f, 82.39246f, 82.97703f, 81.67313f, 82.257706f, 82.99653f, 83.851425f, 84.775024f, 85.72081f, 86.64439f, 87.49931f, 88.23814f, 88.82271f};
        assertArrayEquals((float[])result.getPixels(), expected);
    }

    @Test
    public void blur_and_normalise_test()
    {
        ImageProcessor image = create_test_image(10);
        FloatProcessor result = GaussianBlur.blur_and_normalise(image, 2.355);
        float[] expected = new float[]{0.11457988f, 0.12116116f, 0.12947927f, 0.13910419f, 0.14950205f, 0.16015045f, 0.17054833f, 0.18017322f, 0.18849136f, 0.19507264f, 0.18039268f, 0.18697394f, 0.19529203f, 0.20491695f, 0.21531485f, 0.22596322f, 0.23636113f, 0.24598604f, 0.2543041f, 0.26088545f, 0.26357386f, 0.2701551f, 0.27847323f, 0.28809816f, 0.298496f, 0.30914438f, 0.31954226f, 0.32916716f, 0.33748528f, 0.34406656f, 0.3598228f, 0.36640412f, 0.3747222f, 0.3843471f, 0.39474502f, 0.40539336f, 0.4157913f, 0.42541614f, 0.4337342f, 0.4403155f, 0.4638016f, 0.4703829f, 0.47870103f, 0.48832592f, 0.49872378f, 0.5093722f, 0.5197701f, 0.529395f, 0.53771305f, 0.54429436f, 0.5702855f, 0.57686675f, 0.5851848f, 0.5948098f, 0.60520774f, 0.61585605f, 0.62625396f, 0.6358788f, 0.6441969f, 0.65077823f, 0.67426425f, 0.68084556f, 0.6891636f, 0.6987885f, 0.70918655f, 0.71983486f, 0.7302327f, 0.7398576f, 0.7481756f, 0.75475705f, 0.7705133f, 0.77709454f, 0.7854126f, 0.7950375f, 0.8054354f, 0.81608385f, 0.82648164f, 0.8361065f, 0.8444246f, 0.85100603f, 0.8536944f, 0.8602757f, 0.8685938f, 0.87821865f, 0.88861656f, 0.89926517f, 0.9096627f, 0.9192878f, 0.92760587f, 0.9341871f, 0.91950727f, 0.9260887f, 0.93440664f, 0.9440314f, 0.9544296f, 0.96507764f, 0.9754756f, 0.98510075f, 0.9934187f, 1.0f};
        assertArrayEquals((float[])result.getPixels(), expected);
    }
}
